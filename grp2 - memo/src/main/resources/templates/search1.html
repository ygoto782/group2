<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/css/search/search1.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Á§æÂì°ÊÉÖÂ†±Ê§úÁ¥¢</title>
	<script>
	    function getSelectedIds() {
	        const selectedCheckboxes = document.querySelectorAll('input[type="checkbox"]:checked');
	        return Array.from(selectedCheckboxes).map(checkbox => checkbox.value).join('');
	    }

	    function handleDelete() {
	        const selectedIds = getSelectedIds();
	        if (selectedIds) {
	            const deleteUrl = `/deleteConfirmation?selectedIds=${encodeURIComponent(selectedIds)}`;
	            window.location.href = deleteUrl;
	        } else {
	            alert('ÂâäÈô§„Åô„Çã„É¨„Ç≥„Éº„Éâ„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ');
	        }
	    }

	    function handleRowClick(event) {
	        const row = event.currentTarget;
	        const checkbox = row.querySelector('input[type="checkbox"]');
	        if (checkbox) {
	            checkbox.checked = !checkbox.checked;
	            row.classList.toggle('selected', checkbox.checked);
	        }
	        document.querySelectorAll('tr').forEach(r => {
	            if (r !== row) {
	                r.classList.remove('selected');
	                const otherCheckbox = r.querySelector('input[type="checkbox"]');
	                if (otherCheckbox) {
	                    otherCheckbox.checked = false;
	                }
	            }
	        });
	    }

	    function clearForm() {
	        document.getElementById('searchForm').reset();
	    }

	    function validateInput() {
	        const ageStart = document.getElementById('age_start').value;
	        const ageEnd = document.getElementById('age_end').value;
	        const sdateStart = document.getElementById('sdate_start').value;
	        const sdateEnd = document.getElementById('sdate_end').value;
	        const edateStart = document.getElementById('edate_start').value;
	        const edateEnd = document.getElementById('edate_end').value;

	        let errors = [];

	        // Âπ¥ÈΩ¢Áõ∏Èñ¢„ÉÅ„Çß„ÉÉ„ÇØ
	        if (ageStart && ageEnd && parseInt(ageStart) > parseInt(ageEnd)) {
	            errors.push('Âπ¥ÈΩ¢„ÅÆÂ∑¶ÂÅ¥„ÅÆÂÄ§„ÅåÂè≥ÂÅ¥„ÅÆÂÄ§„Çí‰∏äÂõû„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ');
	        }

	        // ÈñãÂßãÊó•Áõ∏Èñ¢„ÉÅ„Çß„ÉÉ„ÇØ
	        if (sdateStart && sdateEnd && sdateStart > sdateEnd) {
	            errors.push('ÈñãÂßãÊó•„ÅÆÂ∑¶ÂÅ¥„ÅÆÂÄ§„ÅåÂè≥ÂÅ¥„ÅÆÂÄ§„Çí‰∏äÂõû„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ');
	        }

	        // ÁµÇ‰∫ÜÊó•Áõ∏Èñ¢„ÉÅ„Çß„ÉÉ„ÇØ
	        if (edateStart && edateEnd && edateStart > edateEnd) {
	            errors.push('ÁµÇ‰∫ÜÊó•„ÅÆÂ∑¶ÂÅ¥„ÅÆÂÄ§„ÅåÂè≥ÂÅ¥„ÅÆÂÄ§„Çí‰∏äÂõû„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ');
	        }

	        return errors;
	    }

	    document.addEventListener('DOMContentLoaded', function() {
	        document.getElementById('searchForm').onsubmit = function(event) {
	            const errors = validateInput();
	            if (errors.length > 0) {
	                alert(errors.join('\n')); // „Éù„ÉÉ„Éó„Ç¢„ÉÉ„Éó„Åß„Ç®„É©„Éº„ÇíË°®Á§∫
	                event.preventDefault(); // Ê§úÁ¥¢„ÇíË°å„Çè„Å™„ÅÑ
	            }
	        };
	    });
	</script>

</head>
<body>
    <div class="header">
        <div class="topMenu"><h3>Á§æÂì°ÊÉÖÂ†±Ê§úÁ¥¢</h3></div>
        <div class="userBox">
            <span th:text="${userName}">„Äá„Äá„Åï„Çì</span>
            <div id="dateTimer" class="date"></div>
        </div>
    </div>
    <div class="topBox">
        <div class="topBox1">
            <a href="/main1">„É°„Éã„É•„Éº</a>
        </div>
        <div class="topBox2">
            <a href="/signup1">ÁôªÈå≤</a>
        </div>
    </div>

    <div class="main">
        <form id="searchForm" action="/search" method="get">
            <div class="onetwo">
                <div class="t-left">
                    <div class="end">
                        <div class="end1">
                            <div>
                                <span>Á§æÂì°ID</span>
                                <input class="te" type="text" name="id" id="id" pattern="\d*" title="Êï∞ÂÄ§„ÅÆ„Åø">
                            </div>
                            <div>
                                <span>Á§æÂì°Âêç</span>
                                <input class="te" type="text" name="name" id="name">                            
                            </div>
                        </div>
                        <div class="end2">
                            <div>
                                <span>Âπ¥ÈΩ¢</span>
                                <input class="te" type="text" name="age_start" id="age_start" pattern="\d*" title="Êï∞ÂÄ§„ÅÆ„Åø">
                                <span>ÔΩû</span>
                                <input class="te" type="text" name="age_end" id="age_end" pattern="\d*" title="Êï∞ÂÄ§„ÅÆ„Åø">
                            </div>
                            <div>
                                <span>ÈñãÂßãÊó•</span>
                                <input class="te" type="text" name="sdate_start" id="sdate_start" pattern="\d{4}/\d{2}/\d{2}" title="Êó•‰ªò„ÅØyyyy/MM/ddÂΩ¢Âºè„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ">
                                <span>ÔΩû</span>
                                <input class="te" type="text" name="sdate_end" id="sdate_end" pattern="\d{4}/\d{2}/\d{2}" title="Êó•‰ªò„ÅØyyyy/MM/ddÂΩ¢Âºè„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ">
                            </div>
                            <div>
                                <span>ÁµÇ‰∫ÜÊó•</span>
                                <input class="te" type="text" name="edate_start" id="edate_start" pattern="\d{4}/\d{2}/\d{2}" title="Êó•‰ªò„ÅØyyyy/MM/ddÂΩ¢Âºè„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ">
                                <span>ÔΩû</span>
                                <input class="te" type="text" name="edate_end" id="edate_end" pattern="\d{4}/\d{2}/\d{2}" title="Êó•‰ªò„ÅØyyyy/MM/ddÂΩ¢Âºè„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="t-right">
                    <div class="u-left">
                        <button type="submit" class="search-button">Ê§úÁ¥¢</button>
                    </div>
                    <div class="u-right">
                        <button type="reset" class="clear-button" onclick="clearForm()">„ÇØ„É™„Ç¢</button>
                    </div>
                </div>
            </div>
        </form>

        <div class="count">
            <span th:text="${count}">0</span>‰ª∂
        </div>

		<div class="threefour">
		    <div th:if="${errorMessage}" class="no-results">
		        <span th:text="${errorMessage}"></span>
		    </div>
		    
		    <div class="d-left">
		        <table border="1">
		            <tr class="th1">
		                <th class="topbb"><input type="checkbox" value="" checked disabled></th>
		                <th>ID</th>
		                <th>Ê∞èÂêç</th>
		                <th>Âπ¥ÈΩ¢</th>
		                <th>ÈñãÂßãÊó•</th>
		                <th>ÁµÇ‰∫ÜÊó•</th>
		            </tr>
		            <tr th:each="meibo : ${meiboList}" onclick="handleRowClick(event)">
		                <td><input type="checkbox" name="selectedIds" th:value="${meibo.id}" class="record-checkbox" onclick="event.stopPropagation();"></td>
		                <td><a class="id-link" th:href="@{/update1(id=${meibo.id})}" th:text="${meibo.id}"></a></td>
		                <td th:text="${meibo.name}"></td>
		                <td th:text="${meibo.age}"></td>
		                <td th:text="${meibo.sdate}"></td>
		                <td th:text="${meibo.edate}"></td>
		            </tr>
		        </table>
		        <div th:if="${count == 0}" class="no-results">
		            Ë©≤ÂΩì„ÅÆ„Éá„Éº„Çø„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì
		        </div>
		    </div>
		    <div class="d-right">
		        <a href="#" onclick="handleDelete(); return false;" class="delete-button">ÂâäÈô§</a>
		    </div>
		</div>
    </div>
    <script src="/js/timer.js"></script>
</body>
<footer>
    <div class="other"><h6>group2üÑ´2024</h6></div>
</footer>
</html>
