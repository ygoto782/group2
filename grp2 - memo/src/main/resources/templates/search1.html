<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/css/search/search1.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Á§æÂì°ÊÉÖÂ†±Ê§úÁ¥¢</title>
    <script>
        function getSelectedIds() {
            const selectedCheckboxes = document.querySelectorAll('input[type="checkbox"]:checked');
            return Array.from(selectedCheckboxes).map(checkbox => checkbox.value).join(',');
        }

        function handleDelete() {
            const selectedIds = getSelectedIds();
            console.log("Selected IDs:", selectedIds); // ÈÅ∏Êäû„Åï„Çå„ÅüID„Çí„Ç≥„É≥„ÇΩ„Éº„É´„Å´Âá∫Âäõ
            if (selectedIds) {
                const deleteUrl = `/deleteConfirmation?selectedIds=${encodeURIComponent(selectedIds)}`;
                console.log("Redirecting to:", deleteUrl); // „É™„ÉÄ„Ç§„É¨„ÇØ„ÉàÂÖà„ÇíÁ¢∫Ë™ç
                window.location.href = deleteUrl; // URL„Å´ÈÅ∑Áßª
            } else {
                alert('ÂâäÈô§„Åô„Çã„É¨„Ç≥„Éº„Éâ„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ');
            }
        }

        // 1Ë°å„ÅÆ„ÅøÈÅ∏ÊäûÂèØËÉΩ„Å´„Åô„ÇãÈñ¢Êï∞
        function handleRowClick(event) {
            const row = event.currentTarget;
            const checkbox = row.querySelector('input[type="checkbox"]');
            if (checkbox) {
                checkbox.checked = !checkbox.checked; // „ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„ÅÆÁä∂ÊÖã„ÇíÂàá„ÇäÊõø„Åà
                // „ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ„Åå„ÉÅ„Çß„ÉÉ„ÇØ„Åï„Çå„Å¶„ÅÑ„Çã„Åã„Å©„ÅÜ„Åã„ÅßËÉåÊôØËâ≤„ÇíÂ§âÊõ¥
                if (checkbox.checked) {
                    row.classList.add('selected'); // „ÉÅ„Çß„ÉÉ„ÇØ„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà
                } else {
                    row.classList.remove('selected'); // „ÉÅ„Çß„ÉÉ„ÇØ„ÅåÂ§ñ„Çå„ÅüÂ†¥Âêà
                }
            }
            // „Åô„Åπ„Å¶„ÅÆË°å„Åã„ÇâÈÅ∏ÊäûÁä∂ÊÖã„ÇíËß£Èô§
            const rows = document.querySelectorAll('tr');
            rows.forEach(r => {
                if (r !== row) {
                    r.classList.remove('selected'); // ‰ªñ„ÅÆË°å„ÅÆÈÅ∏Êäû„ÇíËß£Èô§
                    const otherCheckbox = r.querySelector('input[type="checkbox"]');
                    if (otherCheckbox) {
                        otherCheckbox.checked = false; // ‰ªñ„ÅÆË°å„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ„ÇíÂ§ñ„Åô
                    }
                }
            });
        }

        function clearForm() {
            document.getElementById('searchForm').reset();
        }
    </script>
    <style>
        .selected {
            background-color: #e0f7fa; /* ÈÅ∏Êäû„Åï„Çå„ÅüË°å„ÅÆËÉåÊôØËâ≤ */
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="topMenu"><h3>Á§æÂì°ÊÉÖÂ†±Ê§úÁ¥¢</h3></div>
        <div class="userBox">
            <span th:text="${userName}">„Äá„Äá„Åï„Çì</span>
            <div id="dateTimer" class="date"></div>
        </div>
    </div>
    <div class="topBox">
        <div class="topBox1">
            <a href="/main1">„É°„Éã„É•„Éº</a>
        </div>
        <div class="topBox2">
            <a href="/signup1">ÁôªÈå≤</a>
        </div>
    </div>

    <div class="main">
        <form id="searchForm" action="/search" method="get">
            <div class="onetwo">
				<div class="t-left">
				    <div class="end">
				        <div class="end1">
				            <div>
				                <span>Á§æÂì°ID</span>
				                <input class="te" type="text" name="id" id="id" pattern="\d*" title="Êï∞ÂÄ§„ÅÆ„Åø">
				            </div>
				            <div>
				                <span>Á§æÂì°Âêç</span>
				                <input class="te" type="text" name="name" id="name">                            
				            </div>
				        </div>
				        <div class="end2">
				            <div>
				                <span>Âπ¥ÈΩ¢</span>
				                <input class="te" type="text" name="age_start" id="age_start" pattern="\d*" title="Êï∞ÂÄ§„ÅÆ„Åø">
				                <span>ÔΩû</span>
				                <input class="te" type="text" name="age_end" id="age_end" pattern="\d*" title="Êï∞ÂÄ§„ÅÆ„Åø">
				            </div>
				            <div>
				                <span>ÈñãÂßãÊó•</span>
				                <input class="te" type="text" name="sdate_start" id="sdate_start" pattern="\d{4}/\d{2}/\d{2}" title="Êó•‰ªò„ÅØyyyy/MM/ddÂΩ¢Âºè„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ">
				                <span>ÔΩû</span>
				                <input class="te" type="text" name="sdate_end" id="sdate_end" pattern="\d{4}/\d{2}/\d{2}" title="Êó•‰ªò„ÅØyyyy/MM/ddÂΩ¢Âºè„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ">
				            </div>
				            <div>
				                <span>ÁµÇ‰∫ÜÊó•</span>
				                <input class="te" type="text" name="edate_start" id="edate_start" pattern="\d{4}/\d{2}/\d{2}" title="Êó•‰ªò„ÅØyyyy/MM/ddÂΩ¢Âºè„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ">
				                <span>ÔΩû</span>
				                <input class="te" type="text" name="edate_end" id="edate_end" pattern="\d{4}/\d{2}/\d{2}" title="Êó•‰ªò„ÅØyyyy/MM/ddÂΩ¢Âºè„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ">
				            </div>
				        </div>
				    </div>
				</div>
                <div class="t-right">
                    <div class="u-left">
                        <button type="submit" class="search-button">Ê§úÁ¥¢</button>
                    </div>
                    <div class="u-right">
                        <button type="reset" class="clear-button" onclick="clearForm()">„ÇØ„É™„Ç¢</button>
                    </div>
                </div>
            </div>
        </form>

        <!-- ‰ª∂Êï∞Ë°®Á§∫ -->
        <div class="count">
            <span th:text="${count}">0</span>‰ª∂
        </div>

        <!-- Ê§úÁ¥¢ÁµêÊûúË°®Á§∫ -->
        <div class="threefour">
            <div class="d-left">
                <table border="1">
                    <tr class="th1">
                        <th class="topbb"><input type="checkbox" value="0" checked disabled></th>
                        <th>ID</th>
                        <th>Ê∞èÂêç</th>
                        <th>Âπ¥ÈΩ¢</th>
                        <th>ÈñãÂßãÊó•</th>
                        <th>ÁµÇ‰∫ÜÊó•</th>
                    </tr>
                    <!-- Ê§úÁ¥¢ÁµêÊûú„ÇíË°®Á§∫„Åô„Çã„Åü„ÇÅ„ÅÆË°å„ÇíËøΩÂä† -->
                    <tr th:each="meibo : ${meiboList}" onclick="handleRowClick(event)">
                        <td><input type="checkbox" name="selectedIds" th:value="${meibo.id}" class="record-checkbox" onclick="event.stopPropagation();"></td>
                        <td><a class="id-link" th:href="@{/update1(id=${meibo.id})}" th:text="${meibo.id}"></a></td>
                        <td th:text="${meibo.name}"></td>
                        <td th:text="${meibo.age}"></td>
                        <td th:text="${meibo.sdate}"></td>
                        <td th:text="${meibo.edate}"></td>
                    </tr>
                </table>
            </div>
            <div class="d-right">
                <a href="#" onclick="handleDelete(); return false;" class="delete-button">ÂâäÈô§</a>
            </div>
        </div>
    </div>
    <script src="/js/timer.js"></script>
</body>
<footer>
    <div class="other"><h6>group2üÑ´2024</h6></div>
</footer>
</html>
